<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>CSS3实现3D 轮播图 By MT</title>
<style>
.carousel3d {
  position: relative;
  margin-left: auto;
  margin-right: auto;
  width: 510px;
  height: 220px;
  perspective: 150px;
  overflow: hidden;
}
.carousel3d-leftarray,
.carousel3d-rightarray {
  position: absolute;
  top: 50%;
  height: 40px;
  width: 30px;
  line-height: 38px;
  font-size: 32px;
  text-align: center;
  background-color: #aaa;
  transform: scaleX(0.5);
  opacity: 0;
  transition: opacity 0.5s;
  cursor: pointer;
}
.carousel3d .carousel3d-rightarray {  right: 0; }
.carousel3d:hover .carousel3d-leftarray {  opacity: 0.3; }
.carousel3d:hover .carousel3d-rightarray {  opacity: 0.3; }
.carousel3d-item {
  position: absolute;
  margin-left: 100px;
  margin-right: 100px;
  transform-origin: 50% 50% -600px;
  transition: transform 1s;
}
.carousel3d-item1 {
  transform: rotateY(120deg);
  transform-origin: 50% 50% 0px;
}
.carousel3d-item--1 {  transform: rotateY(0deg); }
.carousel3d-item--2 {  transform: rotateY(60deg); }
.carousel3d-item--3 {  transform: rotateY(120deg); }
.carousel3d-item--4 {  transform: rotateY(180deg); }
.carousel3d-item--5 {  transform: rotateY(240deg); }
.carousel3d-item--6 {  transform: rotateY(300deg); }
img {  vertical-align: middle; }
</style>
</head>

<body>
<div class="carousel3d">
  <div class="carousel3d-leftarray">&lt;</div>
  <div class="carousel3d-rightarray">&gt;</div>
  <div class="carousel3d-item carousel3d-item--1">
    <img src="carousel1.jpg" alt="图片" />
  </div>
  <div class="carousel3d-item carousel3d-item--2">
    <img src="carousel4.jpg" alt="图片" />
  </div>
  <div class="carousel3d-item carousel3d-item--3">
    <img src="carousel3.jpg" alt="图片" />
  </div>
  <div class="carousel3d-item carousel3d-item--4">
    <img src="carousel5.jpg" alt="图片" />
  </div>
  <div class="carousel3d-item carousel3d-item--5">
    <img src="carousel2.jpg" alt="图片" />
  </div>
  <div class="carousel3d-item carousel3d-item--6">
    <img src="carousel6.jpg" alt="图片" />
  </div>
</div>
<button type="button" id="btn1">180</button>
<button type="button" id="btn2">0</button>
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script>
/*************************轮播功能************************/
/***********************实现3d轮播************************/
/**********************自调用，无接口*********************/
/******************代码未整合，复用率基本为0****************/
$(document).ready(function() {
  //获取需要旋转的容器
  var interval = 2000, //轮播间隔
      carousel3dItem = $(".carousel3d-item"), //轮播图片
      n = carousel3dItem.length, //轮播图片的数量
      count = 0, //现在转过的角度/(360°/n)，取值为-1~6
      angle = -360/n, //轮播图片之间的夹角
      timeout; //记录setTimeout

  /*
   *将每个轮播图片转动一个角度，实现轮播的基本功能
   *param none
   *return undefined
   */
  function rotate() {
    //如果已经转过一圈了，需重置回零
    if (count === n) {
      reset();
      return;
    }
    var i = count++ + 1;
    //改变轮播图片的转动角度
    carousel3dItem.each(function(index) {
      $(this).css("transform", "rotateY(" + i-- * angle + "deg)");
      $(this).css("z-index", calZIndex(index, 1));
    });
    //设置下一次转动
    timeout = setTimeout(rotate, interval);
  }
  /*
   *将每个轮播图片反向转动一个角度
   *param none
   *return undefined
   */
  function rotateReverse() {
    //如果count为-1，需重置为5
    if (count === -1) {
      resetReverse();
      return;
    }
    var i = count-- - 1;
    //改变轮播图片的转动角度
    carousel3dItem.each(function(index) {
      $(this).css("transform", "rotateY(" + i-- * angle + "deg)");
      $(this).css("z-index", calZIndex(index, -1));
    });
    //设置下一次转动
    timeout = setTimeout(rotate, interval);
  }
  /*
   *当轮播图片转过360°时，将转动角度重置
   *param none
   *return undefined
   */
  function reset() {
    var i = 0;
    count = 0;
    //转动角度重置，并删除trasition
    carousel3dItem.each(function() {
      $(this).css({
        "transform": "rotateY(" + i-- * angle + "deg)",
        "transition-property": "none"
      });
    });
    //待重置后，重新添加trasition
    setTimeout(function() {
      carousel3dItem.each(function() {
        $(this).css("transition-property", "transform");
      });
      //设置下一次转动
      rotate();
    }, 15);
  }
  /*
   *当轮播图片转过-360°时，将转动角度重置
   *param none
   *return undefined
   */
  function resetReverse() {
    var i = 5;
    count = 5;
    //转动角度重置，并删除trasition
    carousel3dItem.each(function() {
      $(this).css({
        "transform": "rotateY(" + i-- * angle + "deg)",
        "transition-property": "none"
      });
    });
    //待重置后，重新添加trasition
    setTimeout(function() {
      carousel3dItem.each(function() {
        $(this).css("transition-property", "transform");
      });
      //设置下一次转动
      rotateReverse();
    }, 15);
  }
  /*
   *点击向左箭头是触发的事件，让轮播立刻向左转一个角度
   *param none
   *return undefined
   */
  function leftClick() {
    if (timeout) {
      clearTimeout(timeout);
    }
    rotate();
  }
  /*
   *点击向左箭头是触发的事件，让轮播立刻向左转一个角度
   *param none
   *return undefined
   */
  function rightClick() {
    if (timeout) {
      clearTimeout(timeout);
    }
    rotateReverse();
  }
  /*
   *根据当前的count以及图片在carousel3dItem中的数字索引，求出该图片的z-index
   *index===count的图片的z-index值取n，其两边图片的取n-1，再两边的取n-2，依此类推
   *返回的值为 (count对应的z-index) * 2 + count - (direction) * 1对应的z-index
   *param1 index Number 图片在carousel3dItem中的数字索引
   *param2 direction Number 1 逆时针转动 -1 顺时针转动 0 用于初始化
   *                        可无 取默认值1
   *return Number 求得的该图片的z-index
   */
  function calZIndex(index, direction) {
    //参数处理
    direction = direction || 0;
    var countLocal = count;
    return ZIndex(countLocal) * 2 + ZIndex(countLocal - 1 * direction);
    //计算第index图片和当前第一张图片之间的最短距离
    function ZIndex(countLocal) {
      var delta = Math.abs(index - countLocal);
      return n - Math.min(delta, n - delta);
    }
  }
  
  //以下是初始化
  ////给图片设置初始z-index
  carousel3dItem.each(function(index) {
    $(this).css("z-index", calZIndex(index));
  });
  timeout = setTimeout(rotate, interval);
  $(".carousel3d").on("click", ".carousel3d-leftarray", leftClick);
  $(".carousel3d").on("click", ".carousel3d-rightarray", rightClick);
});
</script>
</body>
</html>